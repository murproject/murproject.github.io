Title: Прошивка платы HighROV по WiFi
Slug: highrov-ota

## Установка необходимых библиотек

Сначала необходимо установить поддержку платы Arduino NANO 33 IoT. Для этого выбираем пункт меню `Инструменты / Плата: … / Менеджер плат`. Необходимо установить пакет `Arduino SAMD Board (32-bits ARM Cortex-M0+)`.

Далее необходимо установить в Arduino IDE некоторые нужные библиотеки, это можено сделать выбрав пункт меню `Скетч / Подключить библиотеку / Управлять библиотеками` (или сочетание клавиш `Ctrl+Shift+I`)

Самое главное, что необходимо установить - библиотека `Arduino OTA`. Рекомендуется ознакомится с [документацией по данной библиотеке](https://github.com/jandrassy/ArduinoOTA).

Помимо этого рекомендуется также установить и другие библиотеки, требуемые для сборки прошивки HighROV:

- `BlueRobotics MS5837`
- `Arduino LSM6DS3`
- `Adafruit PWM Servo Driver`
- `Ethernet2`
- `WiFiNINA`

## Файлы конфигурации

Необходимо поместить два файла конфигурации в директорию, где расположен пакет `Arduino SAMD Board`. Данный путь может различаться на разных системах и версиях. Например, это может быть `C:\Users\Username\AppData\Local\Arduino15\packages\arduino\hardware\samd\1.8.9`

Сначала нужно закрыть все окна Arduino IDE. Затем в данную директорию нужно положить два файла (с перезаписью существующих, но стоит сначала сделать резервную копию), скачивание по ссылкам:

- [platform.local.txt](/media/highrov-ota/platform.local.txt)
- [programmers.txt](/media/highrov-ota/programmers.txt)

![screenshot](/media/highrov-ota/arduino-configs.png)

## Прошивка

Для прошивки выбираем плату `Arduino NANO 33 IoT`, а также нужно выбрать программатор `Arduino OTA SAMD (192.168.1.6)`

![screenshot](/media/highrov-ota/choose-programmer.png)

Загрузку прошивки необходимо производить с помощью функции `Скетч \ Загрузить через программатор`.

![screenshot](/media/highrov-ota/flash-firmware.png)

Пароль по умолчанию - `1`. Он может отличаться у тех проишвок, которые будут загружены пользователем.

![screenshot](/media/highrov-ota/success.png)

Обратите внимание:

- Загружаемые прошивки должны использовать ArduinoOTA для проверки обновлений, иначе последующие обновления по WiFi станут невозможны.
- В случае проблем с прошивкой по WiFi: проверьте подключение к сети, попробуйте перезагрузить плату, полностью выключить питание пульта управления (роутера и платы HighROV) и включить заново. Устройство `192.168.1.6` должно быть доступно по сети и откликаться на `ping`, но только если функционал обновления по WiFi включён в прошивку, которая записана на микроконтроллер.